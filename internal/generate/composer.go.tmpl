// Code generated by algokit-client-generator-go. DO NOT EDIT.
package {{.PackageName}}

import (
	"context"

	algokit "github.com/kylebeee/algokit-utils-go"
)

// Composer builds atomic transaction groups for the {{.ContractName}} contract.
type Composer struct {
	client   *Client
	composer *algokit.TransactionComposer
}

{{range .Methods}}
{{- if .CallConfig.CanCall}}
// {{.Name}} adds a {{.OriginalName}} method call to the transaction group.
func (comp *Composer) {{.Name}}(ctx context.Context{{if .HasArgs}}, params algokit.CallParams[{{.GetArgsStructName}}]{{end}}) (*Composer, error) {
	methodArgs := {{if .HasArgs}}argsToInterface{{.Name}}(params.Args){{else}}[]interface{}(nil){{end}}

	method, err := comp.client.AppClient.AppSpec().Methods[0].ToABIMethod()
	for _, m := range comp.client.AppClient.AppSpec().Methods {
		if m.Name == "{{.OriginalName}}" {
			method, err = m.ToABIMethod()
			break
		}
	}
	if err != nil {
		return nil, err
	}

	err = comp.composer.AddMethodCall(ctx, algokit.MethodCallParams{
		AppID:             comp.client.AppID(),
		Method:            method,
		MethodArgs:        methodArgs,
{{- if .HasArgs}}
		Sender:            params.Sender,
		Signer:            params.Signer,
		Note:              params.Note,
		BoxReferences:     params.BoxReferences,
		AccountReferences: params.AccountReferences,
		AppReferences:     params.AppReferences,
		AssetReferences:   params.AssetReferences,
{{- end}}
	})
	if err != nil {
		return nil, err
	}
	return comp, nil
}
{{end}}
{{end}}

// Send executes the composed transaction group and waits for confirmation.
func (comp *Composer) Send(ctx context.Context) (*algokit.ComposerExecuteResult, error) {
	return comp.composer.Execute(ctx, 5)
}
